#!/usr/bin/env bash

jekyll build

if [ $? -eq 0 ]; then
  mkdir /tmp/jekyll
  rm -rfv /tmp/jekyll/*
  cp -Rv ./_site/* /tmp/jekyll
  git checkout master
  rm -rfv ./*
  cp -Rv /tmp/jekyll/* ./
  git add -A .
  git commit -m "Site published on $(date)"
  git push origin master
  git checkout source
  rm -rfv /tmp/jekyll
  echo "Site published successfully."
else
  echo "Jekyll build failed!"
fi
